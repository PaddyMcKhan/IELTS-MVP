{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/hooks/useWritingTasks.ts"],"sourcesContent":["\"use client\";\n\nimport { useEffect, useState } from \"react\";\n\nexport type WritingTaskRow = {\n  id: string;\n  task_type: string;\n  title: string | null;\n  prompt: string;\n  diagram_alt: string | null;\n  diagram_image_url: string | null;\n  min_words: number;\n  is_active: boolean;\n};\n\ntype UseWritingTasksResult = {\n  tasks: WritingTaskRow[];\n  loading: boolean;\n  error: string | null;\n};\n\nexport function useWritingTasks(taskType: string): UseWritingTasksResult {\n  const [tasks, setTasks] = useState<WritingTaskRow[]>([]);\n  const [loading, setLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!taskType) return;\n\n    let cancelled = false;\n\n    async function load() {\n      setLoading(true);\n      setError(null);\n\n      try {\n        const res = await fetch(\n          `/api/writing-tasks?task_type=${encodeURIComponent(taskType)}`\n        );\n        const json = await res.json();\n\n        if (!res.ok || json.error) {\n          if (!cancelled) {\n            setError(json.error || \"Failed to load writing tasks\");\n            setTasks([]);\n          }\n          return;\n        }\n\n        if (!cancelled) {\n          setTasks((json.tasks ?? []) as WritingTaskRow[]);\n        }\n      } catch (err) {\n        console.error(\"Error loading writing tasks:\", err);\n        if (!cancelled) {\n          setError(\"Failed to load writing tasks\");\n          setTasks([]);\n        }\n      } finally {\n        if (!cancelled) {\n          setLoading(false);\n        }\n      }\n    }\n\n    load();\n\n    return () => {\n      cancelled = true;\n    };\n  }, [taskType]);\n\n  return { tasks, loading, error };\n}\n"],"names":[],"mappings":";;;;AAEA;;AAFA;;AAqBO,SAAS,gBAAgB,QAAgB;;IAC9C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAmB,EAAE;IACvD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IACvC,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAElD,IAAA,0KAAS;qCAAC;YACR,IAAI,CAAC,UAAU;YAEf,IAAI,YAAY;YAEhB,eAAe;gBACb,WAAW;gBACX,SAAS;gBAET,IAAI;oBACF,MAAM,MAAM,MAAM,MAChB,CAAC,6BAA6B,EAAE,mBAAmB,WAAW;oBAEhE,MAAM,OAAO,MAAM,IAAI,IAAI;oBAE3B,IAAI,CAAC,IAAI,EAAE,IAAI,KAAK,KAAK,EAAE;wBACzB,IAAI,CAAC,WAAW;4BACd,SAAS,KAAK,KAAK,IAAI;4BACvB,SAAS,EAAE;wBACb;wBACA;oBACF;oBAEA,IAAI,CAAC,WAAW;wBACd,SAAU,KAAK,KAAK,IAAI,EAAE;oBAC5B;gBACF,EAAE,OAAO,KAAK;oBACZ,QAAQ,KAAK,CAAC,gCAAgC;oBAC9C,IAAI,CAAC,WAAW;wBACd,SAAS;wBACT,SAAS,EAAE;oBACb;gBACF,SAAU;oBACR,IAAI,CAAC,WAAW;wBACd,WAAW;oBACb;gBACF;YACF;YAEA;YAEA;6CAAO;oBACL,YAAY;gBACd;;QACF;oCAAG;QAAC;KAAS;IAEb,OAAO;QAAE;QAAO;QAAS;IAAM;AACjC;GApDgB","debugId":null}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/hooks/useAutosaveDraft.ts"],"sourcesContent":["// src/hooks/useAutosaveDraft.ts\n\"use client\";\n\nimport { useEffect, useRef, useState } from \"react\";\n\nexport type EssayMode = \"academic\" | \"general\";\nexport type EssayTask = \"task1\" | \"task2\";\n\ntype AutosaveStatus = \"idle\" | \"saving\" | \"saved\" | \"error\";\n\ntype UseAutosaveDraftProps = {\n  essay: string;\n  questionId?: string | null;\n  mode: EssayMode;\n  task: EssayTask;\n  enabled: boolean;        // only true when user is logged in & question selected\n  userId?: string | null;  // NEW: we pass this to the API\n  delayMs?: number;\n};\n\nexport function useAutosaveDraft({\n  essay,\n  questionId,\n  mode,\n  task,\n  enabled,\n  userId,\n  delayMs = 3000,\n}: UseAutosaveDraftProps) {\n  const [status, setStatus] = useState<AutosaveStatus>(\"idle\");\n  const [lastSavedAt, setLastSavedAt] = useState<string | null>(null);\n\n  const lastSavedTextRef = useRef<string>(\"\");\n\n  useEffect(() => {\n    if (!enabled) return;\n    if (!questionId) return;\n    if (!userId) return;\n\n    if (essay === lastSavedTextRef.current) return;\n\n    const controller = new AbortController();\n\n    const timeout = setTimeout(async () => {\n      try {\n        setStatus(\"saving\");\n\n        const res = await fetch(\"/api/drafts\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({\n            userId,\n            questionId,\n            mode,\n            task,\n            essay,\n          }),\n          signal: controller.signal,\n        });\n\n        if (!res.ok) {\n          console.error(\"Autosave failed with status:\", res.status);\n          setStatus(\"error\");\n          return;\n        }\n\n        const data = (await res.json()) as { id: string; updatedAt: string };\n        lastSavedTextRef.current = essay;\n        setLastSavedAt(data.updatedAt);\n        setStatus(\"saved\");\n      } catch (err: any) {\n        if (err?.name === \"AbortError\") {\n          return;\n        }\n        console.error(\"Autosave error:\", err);\n        setStatus(\"error\");\n      }\n    }, delayMs);\n\n    return () => {\n      controller.abort();\n      clearTimeout(timeout);\n    };\n  }, [essay, questionId, mode, task, enabled, userId, delayMs]);\n\n  return { status, lastSavedAt };\n}\n"],"names":[],"mappings":"AAAA,gCAAgC;;;;;AAGhC;;AAFA;;AAmBO,SAAS,iBAAiB,EAC/B,KAAK,EACL,UAAU,EACV,IAAI,EACJ,IAAI,EACJ,OAAO,EACP,MAAM,EACN,UAAU,IAAI,EACQ;;IACtB,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAiB;IACrD,MAAM,CAAC,aAAa,eAAe,GAAG,IAAA,yKAAQ,EAAgB;IAE9D,MAAM,mBAAmB,IAAA,uKAAM,EAAS;IAExC,IAAA,0KAAS;sCAAC;YACR,IAAI,CAAC,SAAS;YACd,IAAI,CAAC,YAAY;YACjB,IAAI,CAAC,QAAQ;YAEb,IAAI,UAAU,iBAAiB,OAAO,EAAE;YAExC,MAAM,aAAa,IAAI;YAEvB,MAAM,UAAU;sDAAW;oBACzB,IAAI;wBACF,UAAU;wBAEV,MAAM,MAAM,MAAM,MAAM,eAAe;4BACrC,QAAQ;4BACR,SAAS;gCACP,gBAAgB;4BAClB;4BACA,MAAM,KAAK,SAAS,CAAC;gCACnB;gCACA;gCACA;gCACA;gCACA;4BACF;4BACA,QAAQ,WAAW,MAAM;wBAC3B;wBAEA,IAAI,CAAC,IAAI,EAAE,EAAE;4BACX,QAAQ,KAAK,CAAC,gCAAgC,IAAI,MAAM;4BACxD,UAAU;4BACV;wBACF;wBAEA,MAAM,OAAQ,MAAM,IAAI,IAAI;wBAC5B,iBAAiB,OAAO,GAAG;wBAC3B,eAAe,KAAK,SAAS;wBAC7B,UAAU;oBACZ,EAAE,OAAO,KAAU;wBACjB,IAAI,KAAK,SAAS,cAAc;4BAC9B;wBACF;wBACA,QAAQ,KAAK,CAAC,mBAAmB;wBACjC,UAAU;oBACZ;gBACF;qDAAG;YAEH;8CAAO;oBACL,WAAW,KAAK;oBAChB,aAAa;gBACf;;QACF;qCAAG;QAAC;QAAO;QAAY;QAAM;QAAM;QAAS;QAAQ;KAAQ;IAE5D,OAAO;QAAE;QAAQ;IAAY;AAC/B;GApEgB","debugId":null}},
    {"offset": {"line": 159, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,IAAA,yKAAO,EAAC,IAAA,gJAAI,EAAC;AACtB","debugId":null}},
    {"offset": {"line": 177, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Card({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card\"\n      className={cn(\n        \"bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-header\"\n      className={cn(\n        \"@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-2 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardTitle({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-title\"\n      className={cn(\"leading-none font-semibold\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardDescription({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-description\"\n      className={cn(\"text-muted-foreground text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardAction({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-action\"\n      className={cn(\n        \"col-start-2 row-span-2 row-start-1 self-start justify-self-end\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction CardContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-content\"\n      className={cn(\"px-6\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction CardFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"card-footer\"\n      className={cn(\"flex items-center px-6 [.border-t]:pt-6\", className)}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardAction,\n  CardDescription,\n  CardContent,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;AAEA;;;AAEA,SAAS,KAAK,EAAE,SAAS,EAAE,GAAG,OAAoC;IAChE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,qFACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS;AAaT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,4JACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,UAAU,EAAE,SAAS,EAAE,GAAG,OAAoC;IACrE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,8BAA8B;QAC3C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,gBAAgB,EAAE,SAAS,EAAE,GAAG,OAAoC;IAC3E,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,iCAAiC;QAC9C,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,kEACA;QAED,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,YAAY,EAAE,SAAS,EAAE,GAAG,OAAoC;IACvE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,QAAQ;QACrB,GAAG,KAAK;;;;;;AAGf;MARS;AAUT,SAAS,WAAW,EAAE,SAAS,EAAE,GAAG,OAAoC;IACtE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,2CAA2C;QACxD,GAAG,KAAK;;;;;;AAGf;MARS","debugId":null}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60\",\n        outline:\n          \"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost:\n          \"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-9 px-4 py-2 has-[>svg]:px-3\",\n        sm: \"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5\",\n        lg: \"h-10 rounded-md px-6 has-[>svg]:px-4\",\n        icon: \"size-9\",\n        \"icon-sm\": \"size-8\",\n        \"icon-lg\": \"size-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction Button({\n  className,\n  variant,\n  size,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> &\n  VariantProps<typeof buttonVariants> & {\n    asChild?: boolean\n  }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"button\"\n      className={cn(buttonVariants({ variant, size, className }))}\n      {...props}\n    />\n  )\n}\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;;;AACA;AACA;AAEA;;;;;AAEA,MAAM,iBAAiB,IAAA,0KAAG,EACxB,+bACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OACE;YACF,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;YACN,WAAW;YACX,WAAW;QACb;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AAGF,SAAS,OAAO,EACd,SAAS,EACT,OAAO,EACP,IAAI,EACJ,UAAU,KAAK,EACf,GAAG,OAIF;IACD,MAAM,OAAO,UAAU,2KAAI,GAAG;IAE9B,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,eAAe;YAAE;YAAS;YAAM;QAAU;QACvD,GAAG,KAAK;;;;;;AAGf;KAnBS","debugId":null}},
    {"offset": {"line": 362, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/components/ui/label.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Label({\n  className,\n  ...props\n}: React.ComponentProps<typeof LabelPrimitive.Root>) {\n  return (\n    <LabelPrimitive.Root\n      data-slot=\"label\"\n      className={cn(\n        \"flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Label }\n"],"names":[],"mappings":";;;;;AAGA;AAEA;AALA;;;;AAOA,SAAS,MAAM,EACb,SAAS,EACT,GAAG,OAC8C;IACjD,qBACE,6LAAC,4KAAmB;QAClB,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,uNACA;QAED,GAAG,KAAK;;;;;;AAGf;KAdS","debugId":null}},
    {"offset": {"line": 395, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/components/ui/select.tsx"],"sourcesContent":["\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { CheckIcon, ChevronDownIcon, ChevronUpIcon } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Select({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Root>) {\n  return <SelectPrimitive.Root data-slot=\"select\" {...props} />\n}\n\nfunction SelectGroup({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Group>) {\n  return <SelectPrimitive.Group data-slot=\"select-group\" {...props} />\n}\n\nfunction SelectValue({\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Value>) {\n  return <SelectPrimitive.Value data-slot=\"select-value\" {...props} />\n}\n\nfunction SelectTrigger({\n  className,\n  size = \"default\",\n  children,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Trigger> & {\n  size?: \"sm\" | \"default\"\n}) {\n  return (\n    <SelectPrimitive.Trigger\n      data-slot=\"select-trigger\"\n      data-size={size}\n      className={cn(\n        \"border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <SelectPrimitive.Icon asChild>\n        <ChevronDownIcon className=\"size-4 opacity-50\" />\n      </SelectPrimitive.Icon>\n    </SelectPrimitive.Trigger>\n  )\n}\n\nfunction SelectContent({\n  className,\n  children,\n  position = \"popper\",\n  align = \"center\",\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Content>) {\n  return (\n    <SelectPrimitive.Portal>\n      <SelectPrimitive.Content\n        data-slot=\"select-content\"\n        className={cn(\n          \"bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md\",\n          position === \"popper\" &&\n            \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n          className\n        )}\n        position={position}\n        align={align}\n        {...props}\n      >\n        <SelectScrollUpButton />\n        <SelectPrimitive.Viewport\n          className={cn(\n            \"p-1\",\n            position === \"popper\" &&\n              \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1\"\n          )}\n        >\n          {children}\n        </SelectPrimitive.Viewport>\n        <SelectScrollDownButton />\n      </SelectPrimitive.Content>\n    </SelectPrimitive.Portal>\n  )\n}\n\nfunction SelectLabel({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Label>) {\n  return (\n    <SelectPrimitive.Label\n      data-slot=\"select-label\"\n      className={cn(\"text-muted-foreground px-2 py-1.5 text-xs\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SelectItem({\n  className,\n  children,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Item>) {\n  return (\n    <SelectPrimitive.Item\n      data-slot=\"select-item\"\n      className={cn(\n        \"focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2\",\n        className\n      )}\n      {...props}\n    >\n      <span className=\"absolute right-2 flex size-3.5 items-center justify-center\">\n        <SelectPrimitive.ItemIndicator>\n          <CheckIcon className=\"size-4\" />\n        </SelectPrimitive.ItemIndicator>\n      </span>\n      <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n    </SelectPrimitive.Item>\n  )\n}\n\nfunction SelectSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.Separator>) {\n  return (\n    <SelectPrimitive.Separator\n      data-slot=\"select-separator\"\n      className={cn(\"bg-border pointer-events-none -mx-1 my-1 h-px\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SelectScrollUpButton({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollUpButton>) {\n  return (\n    <SelectPrimitive.ScrollUpButton\n      data-slot=\"select-scroll-up-button\"\n      className={cn(\n        \"flex cursor-default items-center justify-center py-1\",\n        className\n      )}\n      {...props}\n    >\n      <ChevronUpIcon className=\"size-4\" />\n    </SelectPrimitive.ScrollUpButton>\n  )\n}\n\nfunction SelectScrollDownButton({\n  className,\n  ...props\n}: React.ComponentProps<typeof SelectPrimitive.ScrollDownButton>) {\n  return (\n    <SelectPrimitive.ScrollDownButton\n      data-slot=\"select-scroll-down-button\"\n      className={cn(\n        \"flex cursor-default items-center justify-center py-1\",\n        className\n      )}\n      {...props}\n    >\n      <ChevronDownIcon className=\"size-4\" />\n    </SelectPrimitive.ScrollDownButton>\n  )\n}\n\nexport {\n  Select,\n  SelectContent,\n  SelectGroup,\n  SelectItem,\n  SelectLabel,\n  SelectScrollDownButton,\n  SelectScrollUpButton,\n  SelectSeparator,\n  SelectTrigger,\n  SelectValue,\n}\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;AAGA;AACA;AAAA;AAAA;AAEA;AANA;;;;;AAQA,SAAS,OAAO,EACd,GAAG,OAC+C;IAClD,qBAAO,6LAAC,6KAAoB;QAAC,aAAU;QAAU,GAAG,KAAK;;;;;;AAC3D;KAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,YAAY,EACnB,GAAG,OACgD;IACnD,qBAAO,6LAAC,8KAAqB;QAAC,aAAU;QAAgB,GAAG,KAAK;;;;;;AAClE;MAJS;AAMT,SAAS,cAAc,EACrB,SAAS,EACT,OAAO,SAAS,EAChB,QAAQ,EACR,GAAG,OAGJ;IACC,qBACE,6LAAC,gLAAuB;QACtB,aAAU;QACV,aAAW;QACX,WAAW,IAAA,4HAAE,EACX,gzBACA;QAED,GAAG,KAAK;;YAER;0BACD,6LAAC,6KAAoB;gBAAC,OAAO;0BAC3B,cAAA,6LAAC,8OAAe;oBAAC,WAAU;;;;;;;;;;;;;;;;;AAInC;MAxBS;AA0BT,SAAS,cAAc,EACrB,SAAS,EACT,QAAQ,EACR,WAAW,QAAQ,EACnB,QAAQ,QAAQ,EAChB,GAAG,OACkD;IACrD,qBACE,6LAAC,+KAAsB;kBACrB,cAAA,6LAAC,gLAAuB;YACtB,aAAU;YACV,WAAW,IAAA,4HAAE,EACX,ijBACA,aAAa,YACX,mIACF;YAEF,UAAU;YACV,OAAO;YACN,GAAG,KAAK;;8BAET,6LAAC;;;;;8BACD,6LAAC,iLAAwB;oBACvB,WAAW,IAAA,4HAAE,EACX,OACA,aAAa,YACX;8BAGH;;;;;;8BAEH,6LAAC;;;;;;;;;;;;;;;;AAIT;MAnCS;AAqCT,SAAS,YAAY,EACnB,SAAS,EACT,GAAG,OACgD;IACnD,qBACE,6LAAC,8KAAqB;QACpB,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,6CAA6C;QAC1D,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,WAAW,EAClB,SAAS,EACT,QAAQ,EACR,GAAG,OAC+C;IAClD,qBACE,6LAAC,6KAAoB;QACnB,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,6aACA;QAED,GAAG,KAAK;;0BAET,6LAAC;gBAAK,WAAU;0BACd,cAAA,6LAAC,sLAA6B;8BAC5B,cAAA,6LAAC,wNAAS;wBAAC,WAAU;;;;;;;;;;;;;;;;0BAGzB,6LAAC,iLAAwB;0BAAE;;;;;;;;;;;;AAGjC;MAtBS;AAwBT,SAAS,gBAAgB,EACvB,SAAS,EACT,GAAG,OACoD;IACvD,qBACE,6LAAC,kLAAyB;QACxB,aAAU;QACV,WAAW,IAAA,4HAAE,EAAC,iDAAiD;QAC9D,GAAG,KAAK;;;;;;AAGf;MAXS;AAaT,SAAS,qBAAqB,EAC5B,SAAS,EACT,GAAG,OACyD;IAC5D,qBACE,6LAAC,uLAA8B;QAC7B,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,wOAAa;YAAC,WAAU;;;;;;;;;;;AAG/B;MAhBS;AAkBT,SAAS,uBAAuB,EAC9B,SAAS,EACT,GAAG,OAC2D;IAC9D,qBACE,6LAAC,yLAAgC;QAC/B,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,wDACA;QAED,GAAG,KAAK;kBAET,cAAA,6LAAC,8OAAe;YAAC,WAAU;;;;;;;;;;;AAGjC;MAhBS","debugId":null}},
    {"offset": {"line": 653, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/components/Timer.tsx"],"sourcesContent":["'use client';\nimport { useEffect, useState } from 'react';\n\ntype TimerProps = {\n  initialSeconds: number;\n  isRunning: boolean;\n  onComplete?: () => void;\n};\n\nexport default function Timer({ initialSeconds, isRunning, onComplete }: TimerProps) {\n  const [remaining, setRemaining] = useState(initialSeconds);\n\n  // Reset remaining whenever the configured duration changes\n  useEffect(() => {\n    setRemaining(initialSeconds);\n  }, [initialSeconds]);\n\n  useEffect(() => {\n    if (!isRunning) return;\n\n    const id = window.setInterval(() => {\n      setRemaining((prev) => {\n        if (prev <= 1) {\n          window.clearInterval(id);\n          onComplete?.();\n          return 0;\n        }\n        return prev - 1;\n      });\n    }, 1000);\n\n    return () => window.clearInterval(id);\n  }, [isRunning, onComplete]);\n\n  const mins = String(Math.floor(remaining / 60)).padStart(2, '0');\n  const secs = String(remaining % 60).padStart(2, '0');\n\n  return (\n    <div className=\"text-lg tabular-nums font-medium\" aria-live=\"polite\">\n      ‚è±Ô∏è {mins}:{secs}\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;;;AADA;;AASe,SAAS,MAAM,EAAE,cAAc,EAAE,SAAS,EAAE,UAAU,EAAc;;IACjF,MAAM,CAAC,WAAW,aAAa,GAAG,IAAA,yKAAQ,EAAC;IAE3C,2DAA2D;IAC3D,IAAA,0KAAS;2BAAC;YACR,aAAa;QACf;0BAAG;QAAC;KAAe;IAEnB,IAAA,0KAAS;2BAAC;YACR,IAAI,CAAC,WAAW;YAEhB,MAAM,KAAK,OAAO,WAAW;sCAAC;oBAC5B;8CAAa,CAAC;4BACZ,IAAI,QAAQ,GAAG;gCACb,OAAO,aAAa,CAAC;gCACrB;gCACA,OAAO;4BACT;4BACA,OAAO,OAAO;wBAChB;;gBACF;qCAAG;YAEH;mCAAO,IAAM,OAAO,aAAa,CAAC;;QACpC;0BAAG;QAAC;QAAW;KAAW;IAE1B,MAAM,OAAO,OAAO,KAAK,KAAK,CAAC,YAAY,KAAK,QAAQ,CAAC,GAAG;IAC5D,MAAM,OAAO,OAAO,YAAY,IAAI,QAAQ,CAAC,GAAG;IAEhD,qBACE,6LAAC;QAAI,WAAU;QAAmC,aAAU;;YAAS;YAC/D;YAAK;YAAE;;;;;;;AAGjB;GAjCwB;KAAA","debugId":null}},
    {"offset": {"line": 727, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/components/ui/textarea.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\n  return (\n    <textarea\n      data-slot=\"textarea\"\n      className={cn(\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Textarea }\n"],"names":[],"mappings":";;;;;AAEA;;;AAEA,SAAS,SAAS,EAAE,SAAS,EAAE,GAAG,OAAyC;IACzE,qBACE,6LAAC;QACC,aAAU;QACV,WAAW,IAAA,4HAAE,EACX,ucACA;QAED,GAAG,KAAK;;;;;;AAGf;KAXS","debugId":null}},
    {"offset": {"line": 757, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/components/EssayBox.tsx"],"sourcesContent":["'use client';\nimport { useEffect, useMemo, useState } from 'react';\nimport { Textarea } from \"@/components/ui/textarea\";\n\ntype Props = {\n  value: string;\n  onChange: (v: string) => void;\n};\n\nexport default function EssayBox({ value, onChange }: Props) {\n  const [hydrated, setHydrated] = useState(false);\n\n  // Mark when we are safely running on the client\n  useEffect(() => {\n    setHydrated(true);\n  }, []);\n\n  const words = useMemo(\n    () => (value.trim() ? value.trim().split(/\\s+/).length : 0),\n    [value]\n  );\n\n  // Before hydration, just show 0 to avoid mismatch\n  const displayWords = hydrated ? words : 0;\n\n  return (\n    <div className=\"space-y-2\">\n      <div className=\"flex items-center justify-between text-sm text-slate-600\">\n        <span>Write your essay here‚Ä¶</span>\n        <span>\n          Word count:{' '}\n          <strong\n            className=\"tabular-nums\"\n            suppressHydrationWarning\n          >\n            {displayWords}\n          </strong>\n        </span>\n      </div>\n      <Textarea\n        className=\"min-h-[360px] text-base\"\n        value={value}\n        onChange={(e) => onChange(e.target.value)}\n        placeholder=\"Type your response‚Ä¶\"\n      />\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;;AACA;AACA;;;AAFA;;;AASe,SAAS,SAAS,EAAE,KAAK,EAAE,QAAQ,EAAS;;IACzD,MAAM,CAAC,UAAU,YAAY,GAAG,IAAA,yKAAQ,EAAC;IAEzC,gDAAgD;IAChD,IAAA,0KAAS;8BAAC;YACR,YAAY;QACd;6BAAG,EAAE;IAEL,MAAM,QAAQ,IAAA,wKAAO;mCACnB,IAAO,MAAM,IAAI,KAAK,MAAM,IAAI,GAAG,KAAK,CAAC,OAAO,MAAM,GAAG;kCACzD;QAAC;KAAM;IAGT,kDAAkD;IAClD,MAAM,eAAe,WAAW,QAAQ;IAExC,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;kCAAK;;;;;;kCACN,6LAAC;;4BAAK;4BACQ;0CACZ,6LAAC;gCACC,WAAU;gCACV,wBAAwB;0CAEvB;;;;;;;;;;;;;;;;;;0BAIP,6LAAC,mJAAQ;gBACP,WAAU;gBACV,OAAO;gBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;gBACxC,aAAY;;;;;;;;;;;;AAIpB;GAtCwB;KAAA","debugId":null}},
    {"offset": {"line": 851, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/hooks/useLocalStorage.ts"],"sourcesContent":["'use client';\n\nimport { useEffect, useState } from 'react';\n\nexport default function useLocalStorage(key: string, initialValue: string) {\n  const [value, setValue] = useState<string>(() => {\n    if (typeof window === 'undefined') return initialValue;\n    try {\n      const raw = window.localStorage.getItem(key);\n      return raw !== null ? raw : initialValue;\n    } catch {\n      return initialValue;\n    }\n  });\n\n  useEffect(() => {\n    try {\n      window.localStorage.setItem(key, value);\n    } catch {}\n  }, [key, value]);\n\n  return [value, setValue] as const;\n}\n"],"names":[],"mappings":";;;;AAEA;;AAFA;;AAIe,SAAS,gBAAgB,GAAW,EAAE,YAAoB;;IACvE,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ;oCAAS;YACzC;;YACA,IAAI;gBACF,MAAM,MAAM,OAAO,YAAY,CAAC,OAAO,CAAC;gBACxC,OAAO,QAAQ,OAAO,MAAM;YAC9B,EAAE,OAAM;gBACN,OAAO;YACT;QACF;;IAEA,IAAA,0KAAS;qCAAC;YACR,IAAI;gBACF,OAAO,YAAY,CAAC,OAAO,CAAC,KAAK;YACnC,EAAE,OAAM,CAAC;QACX;oCAAG;QAAC;QAAK;KAAM;IAEf,OAAO;QAAC;QAAO;KAAS;AAC1B;GAlBwB","debugId":null}},
    {"offset": {"line": 896, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/components/BandScoreModal.tsx"],"sourcesContent":["'use client';\n\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\n\ntype Scores = {\n  taskResponse: number;\n  coherence: number;\n  lexical: number;\n  grammar: number;\n};\n\ntype BandScoreModalProps = {\n  task: 'task1' | 'task2';\n  wordCount: number;\n  minWords: number;\n  aiData: any;\n  prediction: Scores | null;\n  isPro: boolean;\n  onClose: () => void;\n};\n\nfunction roundToHalf(n: number): number {\n  return Math.round(n * 2) / 2;\n}\n\nexport default function BandScoreModal({\n  task,\n  wordCount,\n  minWords,\n  aiData,\n  prediction,\n  isPro,\n  onClose,\n}: BandScoreModalProps) {\n  const aiOverall =\n    typeof aiData.overall === 'number'\n      ? aiData.overall\n      : roundToHalf(\n          (aiData.taskResponse +\n            aiData.coherence +\n            aiData.lexical +\n            aiData.grammar) /\n          4\n        );\n\n  let predictedOverall: number | null = null;\n  if (prediction) {\n    predictedOverall = roundToHalf(\n      (prediction.taskResponse +\n        prediction.coherence +\n        prediction.lexical +\n        prediction.grammar) /\n      4\n    );\n  }\n\n  return (\n    <Card className=\"p-6 space-y-6\">\n      <div className=\"flex items-start justify-between gap-4\">\n        <div>\n          <h2 className=\"text-lg font-semibold\">Band Score Results</h2>\n          <p className=\"text-xs text-slate-500\">\n            AI examiner scoring ‚Äî practice estimate only. Model:{' '}\n            {isPro ? 'Pro (gpt-4o)' : 'Free (gpt-4o-mini)'}\n          </p>\n        </div>\n        <Button\n          variant=\"outline\"\n          size=\"sm\"\n          onClick={onClose}\n        >\n          Hide feedback\n        </Button>\n      </div>\n\n      <div className=\"flex flex-wrap items-center justify-between gap-3 text-sm text-slate-600\">\n        <span>\n          <strong>Task:</strong> {task === 'task1' ? 'Task 1' : 'Task 2'}\n        </span>\n        <span>\n          <strong>Words:</strong> {wordCount} (min {minWords})\n        </span>\n      </div>\n\n      {/* Overall bands */}\n      <div className=\"grid gap-4 md:grid-cols-2\">\n        {prediction && predictedOverall !== null ? (\n          <div className=\"rounded-md bg-slate-50 p-4\">\n            <p className=\"text-xs uppercase text-slate-500\">Your predicted overall band</p>\n            <div className=\"mt-1 flex items-baseline gap-2\">\n              <span className=\"text-3xl font-semibold\">\n                {predictedOverall.toFixed(1)}\n              </span>\n            </div>\n          </div>\n        ) : (\n          <div className=\"rounded-md bg-slate-50 p-4\">\n            <p className=\"text-xs uppercase text-slate-500\">Your prediction</p>\n            <p className=\"mt-1 text-xs text-slate-500\">\n              No prediction recorded for this attempt.\n            </p>\n          </div>\n        )}\n\n        <div className=\"rounded-md bg-slate-50 p-4\">\n          <p className=\"text-xs uppercase text-slate-500\">AI examiner overall band</p>\n          <div className=\"mt-1 flex items-baseline gap-2\">\n            <span className=\"text-4xl font-bold\">{aiOverall.toFixed(1)}</span>\n          </div>\n          <div className=\"mt-3 h-2 w-full overflow-hidden rounded-full bg-slate-200\">\n            <div\n              className=\"h-full rounded-full bg-emerald-500\"\n              style={{ width: `${(aiOverall / 9) * 100}%` }}\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* Criterion comparison table */}\n      <div className=\"overflow-x-auto text-sm\">\n        <table className=\"w-full border-collapse text-left\">\n          <thead>\n            <tr className=\"border-b text-xs text-slate-500\">\n              <th className=\"py-2 pr-3\">Criterion</th>\n              <th className=\"py-2 pr-3\">\n                Your prediction\n              </th>\n              <th className=\"py-2 pr-3\">\n                AI examiner band\n              </th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr className=\"border-b align-top\">\n              <td className=\"py-2 pr-3 font-medium\">Task Response</td>\n              <td className=\"py-2 pr-3 text-slate-600\">\n                {prediction ? prediction.taskResponse.toFixed(1) : '‚Äî'}\n              </td>\n              <td className=\"py-2 pr-3 text-slate-900\">\n                {aiData.taskResponse.toFixed(1)}\n                <p className=\"mt-1 text-xs text-slate-600\">\n                  {aiData.comments?.taskResponse}\n                </p>\n              </td>\n            </tr>\n            <tr className=\"border-b align-top\">\n              <td className=\"py-2 pr-3 font-medium\">Coherence & Cohesion</td>\n              <td className=\"py-2 pr-3 text-slate-600\">\n                {prediction ? prediction.coherence.toFixed(1) : '‚Äî'}\n              </td>\n              <td className=\"py-2 pr-3 text-slate-900\">\n                {aiData.coherence.toFixed(1)}\n                <p className=\"mt-1 text-xs text-slate-600\">\n                  {aiData.comments?.coherence}\n                </p>\n              </td>\n            </tr>\n            <tr className=\"border-b align-top\">\n              <td className=\"py-2 pr-3 font-medium\">Lexical Resource</td>\n              <td className=\"py-2 pr-3 text-slate-600\">\n                {prediction ? prediction.lexical.toFixed(1) : '‚Äî'}\n              </td>\n              <td className=\"py-2 pr-3 text-slate-900\">\n                {aiData.lexical.toFixed(1)}\n                <p className=\"mt-1 text-xs text-slate-600\">\n                  {aiData.comments?.lexical}\n                </p>\n              </td>\n            </tr>\n            <tr className=\"align-top\">\n              <td className=\"py-2 pr-3 font-medium\">Grammar Range & Accuracy</td>\n              <td className=\"py-2 pr-3 text-slate-600\">\n                {prediction ? prediction.grammar.toFixed(1) : '‚Äî'}\n              </td>\n              <td className=\"py-2 pr-3 text-slate-900\">\n                {aiData.grammar.toFixed(1)}\n                <p className=\"mt-1 text-xs text-slate-600\">\n                  {aiData.comments?.grammar}\n                </p>\n              </td>\n            </tr>\n          </tbody>\n        </table>\n      </div>\n\n      {/* Overview + Advice */}\n      <div className=\"space-y-3 text-sm\">\n        <div className=\"rounded-md bg-slate-50 p-3\">\n          <p>\n            <strong>Overview:</strong>{' '}\n            <span className=\"text-slate-700\">\n              {aiData.comments?.overview}\n            </span>\n          </p>\n        </div>\n        <div className=\"rounded-md bg-slate-50 p-3\">\n          <p>\n            <strong>Advice to Improve:</strong>{' '}\n            <span className=\"text-slate-700\">\n              {aiData.comments?.advice}\n            </span>\n          </p>\n        </div>\n      </div>\n    </Card>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}},
    {"offset": {"line": 1449, "column": 0}, "map": {"version":3,"sources":["file:///Users/lordp/IELTS-MVP/src/app/page.tsx"],"sourcesContent":["'use client';\n\nimport { useEffect, useMemo, useState } from 'react';\nimport { useWritingTasks } from \"@/hooks/useWritingTasks\";\nimport { useSupabaseSession } from \"@/components/SupabaseSessionProvider\";\nimport { useAutosaveDraft } from \"@/hooks/useAutosaveDraft\";\nimport { Card } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport Link from \"next/link\";\nimport Timer from '@/components/Timer';\nimport EssayBox from '@/components/EssayBox';\nimport useLocalStorage from '@/hooks/useLocalStorage';\nimport BandScoreModal from '@/components/BandScoreModal';\n\n// Default IELTS durations\nfunction defaultDurationForTask(task: 'task1' | 'task2'): number {\n  return task === 'task1' ? 20 * 60 : 40 * 60;\n}\n\nfunction countWords(text: string): number {\n  return text.trim() ? text.trim().split(/\\s+/).length : 0;\n}\n\ntype Scores = {\n  taskResponse: number;\n  coherence: number;\n  lexical: number;\n  grammar: number;\n};\n\ntype AttemptRow = {\n  id: string;\n  user_id: string | null;\n  question_id: string;\n  essay_text: string;\n  score_json: any;\n  created_at: string;\n};\n\nexport default function Home() {\n  const { session } = useSupabaseSession();\n  const userId = (session?.user as any)?.id ?? null;\n\n  const [mode, setMode] = useState<'academic' | 'general'>('academic');\n  const [task, setTask] = useState<'task1' | 'task2'>('task2');\n  const [selectedTaskId, setSelectedTaskId] = useState<string | null>(null);\n\n  // Map UI mode/task to DB task_type (e.g. \"task2_academic\")\n  const dbTaskType = useMemo(\n    () => `${task}_${mode === \"academic\" ? \"academic\" : \"general\"}`,\n    [task, mode]\n  );\n\n  const { tasks, loading: tasksLoading, error: tasksError } = useWritingTasks(\n    dbTaskType\n  );\n\n  const selectedTask = useMemo(() => {\n    if (!tasks || tasks.length === 0) return null;\n    if (selectedTaskId) {\n      const found = tasks.find((t: any) => t.id === selectedTaskId);\n      if (found) return found;\n    }\n    return tasks[0];\n  }, [tasks, selectedTaskId]);\n\n  const [duration, setDuration] = useState<number>(defaultDurationForTask(task));\n  const [isRunning, setIsRunning] = useState(false);\n  const [resetToken, setResetToken] = useState(0);\n\n  // Pro toggle: free (gpt-4o-mini) vs pro (gpt-4o)\n  const [isPro, setIsPro] = useState(false);\n\n  const storageKey = useMemo(\n    () => `ielts:essay:${mode}:${task}:${selectedTaskId ?? 'none'}`,\n    [mode, task, selectedTaskId]\n  );\n\n  const [essay, setEssay] = useLocalStorage(storageKey, '');\n  const currentWordCount = useMemo(() => countWords(essay), [essay]);\n\n  const prompt = selectedTask?.prompt ?? '';\n  const minWords = selectedTask?.min_words ?? (task === \"task1\" ? 150 : 250);\n\n  // Ensure we always have a selectedTaskId once tasks load\n  useEffect(() => {\n    if (!selectedTaskId && tasks && tasks.length > 0) {\n      setSelectedTaskId(tasks[0].id);\n    }\n  }, [tasks, selectedTaskId]);\n\n  // üîÅ Cloud autosave hook (Step 9C)\n  const { status: autosaveStatus, lastSavedAt } = useAutosaveDraft({\n    essay,\n    questionId: selectedTaskId,\n    mode,\n    task,\n    enabled: !!userId && !!selectedTaskId,\n    userId,\n  });\n\n  // Self-assessment sliders (student prediction)\n  const [selfScores, setSelfScores] = useState<Scores>({\n    taskResponse: 6,\n    coherence: 6,\n    lexical: 6,\n    grammar: 6,\n  });\n  const [hasPrediction, setHasPrediction] = useState(false);\n  const [predictionLocked, setPredictionLocked] = useState(false);\n  const [prediction, setPrediction] = useState<Scores | null>(null);\n\n  // LIVE predicted overall from sliders\n  const livePredictedOverall = useMemo(() => {\n    const avg =\n      (selfScores.taskResponse +\n        selfScores.coherence +\n        selfScores.lexical +\n        selfScores.grammar) / 4;\n    return Math.round(avg * 2) / 2;\n  }, [selfScores]);\n\n  // Modal / results data\n  const [showResults, setShowResults] = useState(false);\n  const [aiResult, setAiResult] = useState<any | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n\n  // History (Step 8D / 8E)\n  const [attempts, setAttempts] = useState<AttemptRow[]>([]);\n  const [historyLoading, setHistoryLoading] = useState(false);\n  const [historyError, setHistoryError] = useState<string | null>(null);\n\n  // Welcome-back modal (Step 12C)\n  const [showWelcomeModal, setShowWelcomeModal] = useState(false);\n\n  // Load attempts from /api/attempts (optionally filtered by userId)\n  const progressSummary = useMemo(() => {\n    if (!attempts || attempts.length === 0) {\n      return null;\n    }\n\n    const overallScores: number[] = [];\n\n    for (const attempt of attempts) {\n      const overall = (attempt as any)?.score_json?.overall;\n      if (typeof overall === \"number\") {\n        overallScores.push(overall);\n      }\n    }\n\n    const totalAttempts = attempts.length;\n    const scoredAttempts = overallScores.length;\n\n    if (scoredAttempts === 0) {\n      return {\n        totalAttempts,\n        scoredAttempts,\n        bestOverall: null as number | null,\n        averageOverall: null as number | null,\n        lastOverall: null as number | null,\n      };\n    }\n\n    const bestOverall = Math.max(...overallScores);\n    const averageOverall =\n      overallScores.reduce((sum, score) => sum + score, 0) / scoredAttempts;\n\n    // Assuming newest attempt is first ‚Äì use that as ‚Äúlast‚Äù\n    const lastOverall = overallScores[0];\n\n    return {\n      totalAttempts,\n      scoredAttempts,\n      bestOverall,\n      averageOverall,\n      lastOverall,\n    };\n  }, [attempts]);\n\n  async function loadAttempts() {\n    setHistoryLoading(true);\n    setHistoryError(null);\n    try {\n      const q = userId ? `?userId=${encodeURIComponent(userId)}` : \"\";\n      const res = await fetch(`/api/attempts${q}`);\n      const json = await res.json();\n      if (!res.ok || json.error) {\n        setHistoryError(json.error || \"Failed to load attempts\");\n        return;\n      }\n      setAttempts(json.attempts ?? []);\n    } catch (err) {\n      console.error(\"Failed to load attempts:\", err);\n      setHistoryError(\"Failed to load attempts\");\n    } finally {\n      setHistoryLoading(false);\n    }\n  }\n\n  // Before unload warning\n  useEffect(() => {\n    const handler = (e: BeforeUnloadEvent) => {\n      if (essay.trim().length > 0) {\n        e.preventDefault();\n        e.returnValue = '';\n      }\n    };\n    window.addEventListener('beforeunload', handler);\n    return () => window.removeEventListener('beforeunload', handler);\n  }, [essay]);\n\n  // Initial load of history (re-run if userId changes)\n  useEffect(() => {\n    loadAttempts();\n  }, [userId]);\n\n  // Welcome-back progress popup (Step 12C)\n  useEffect(() => {\n    if (!userId) return;\n    if (!progressSummary) return;         // need stats to show\n    if (historyLoading || historyError) return;\n\n    try {\n      const key = `ielts:welcomeSeen:${userId}`;\n      const seen = window.localStorage.getItem(key);\n      if (seen === \"1\") return;\n\n      setShowWelcomeModal(true);\n      window.localStorage.setItem(key, \"1\");\n    } catch (err) {\n      console.error(\"Welcome modal localStorage error:\", err);\n    }\n  }, [userId, progressSummary, historyLoading, historyError]);\n\n  // Load cloud draft when a question is selected (Step 9D)\n  useEffect(() => {\n    if (!userId || !selectedTaskId) return;\n\n    let cancelled = false;\n\n    async function fetchDraft() {\n      try {\n        const res = await fetch(\n          `/api/drafts?questionId=${encodeURIComponent(\n            selectedTaskId\n          )}&userId=${encodeURIComponent(userId)}`\n        );\n\n        if (!res.ok) {\n          console.error(\"Failed to load draft:\", res.status);\n          return;\n        }\n\n        const json = await res.json();\n\n        if (cancelled) return;\n        if (!json.draft) {\n          return;\n        }\n\n        // Hydrate editor with server draft\n        setEssay(json.draft.essay as string);\n      } catch (err) {\n        console.error(\"Error loading draft:\", err);\n      }\n    }\n\n    fetchDraft();\n\n    return () => {\n      cancelled = true;\n    };\n  }, [userId, selectedTaskId, setEssay]);\n\n  // Reset all feedback state\n  const resetFeedback = () => {\n    setAiResult(null);\n    setShowResults(false);\n    setPredictionLocked(false);\n    setHasPrediction(false);\n    setPrediction(null);\n    setSelfScores({\n      taskResponse: 6,\n      coherence: 6,\n      lexical: 6,\n      grammar: 6,\n    });\n  };\n\n  // Handle submit ‚Üí AI scoring + save attempt\n  const handleSubmit = async () => {\n    // Step 11D: make sure a DB question is selected\n    if (!selectedTaskId || !selectedTask) {\n      alert(\"Please choose a question before submitting your essay.\");\n      return;\n    }\n\n    if (currentWordCount < minWords) {\n      const proceed = window.confirm(\n        `You have written ${currentWordCount} words, but the minimum for ${task === 'task1' ? 'Task 1' : 'Task 2'\n        } is ${minWords}. Submitting fewer words may reduce your Task Response score.\\n\\nProceed anyway?`\n      );\n      if (!proceed) return;\n    }\n\n    const predictionPayload = hasPrediction ? { ...selfScores } : null;\n\n    if (predictionPayload) {\n      setPrediction(predictionPayload);\n    } else {\n      setPrediction(null);\n    }\n    setPredictionLocked(true);\n\n    setIsRunning(false);\n    setIsLoading(true);\n\n    try {\n      const query = isPro ? '?pro=true' : '';\n      const res = await fetch(`/api/score${query}`, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({\n          essay,\n          task,                     // \"task1\" or \"task2\" (UI level)\n          wordCount: currentWordCount,\n          question: prompt,\n\n          // üîë Step 11D wiring into DB world\n          questionId: selectedTaskId,        // writing_tasks.id\n          taskType: selectedTask?.task_type, // e.g. \"task2_academic\"\n          minWords,                          // DB min_words (or fallback)\n        }),\n      });\n\n      const data = await res.json();\n\n      if (data.error) {\n        alert(\"Scoring failed: \" + data.error);\n        setIsLoading(false);\n        return;\n      }\n\n      const scoreToStore = predictionPayload\n        ? { ...data, prediction: predictionPayload }\n        : data;\n\n      // Save to Supabase (Step 8D/8E + schema update patch)\n      if (selectedTaskId) {\n        try {\n          const {\n            taskResponse,\n            coherence,\n            lexical,\n            grammar,\n            overall,\n          } = data;\n\n          await fetch(\"/api/attempts\", {\n            method: \"POST\",\n            headers: { \"Content-Type\": \"application/json\" },\n            body: JSON.stringify({\n              // high-level context\n              module: mode,                 // \"academic\" | \"general\"\n              task,                         // \"task1\" | \"task2\"\n\n              // question metadata\n              questionId: selectedTaskId,   // writing_tasks.id\n              questionText: prompt,         // full prompt text\n\n              // essay content\n              essay,                        // legacy field (ok if server ignores)\n              essayText: essay,             // main essay column\n              wordCount: currentWordCount,\n\n              // scoring + model info\n              isPro,\n              userId: userId ?? null,\n              scoreJson: scoreToStore,      // full JSON for score_json column\n              coherence,\n              lexical,\n              grammar,\n              taskResponse,\n              overallBand:\n                typeof overall === \"number\" ? overall : undefined,\n            }),\n          });\n\n          await loadAttempts();\n        } catch (saveErr) {\n          console.error(\"Failed to save essay attempt:\", saveErr);\n        }\n      }\n\n      setAiResult(data);\n      setShowResults(true);\n\n    } catch (err) {\n      alert(\"Error scoring essay\");\n      console.error(err);\n    }\n\n    setIsLoading(false);\n  };\n\n  // Loading screen while scoring\n  if (isLoading) {\n    return (\n      <main className=\"min-h-dvh flex items-center justify-center bg-white text-slate-900\">\n        <div className=\"text-center space-y-4\">\n          <div className=\"animate-spin text-4xl\">‚è≥</div>\n          <p className=\"text-sm text-slate-600\">Scoring your essay with AI examiner‚Ä¶</p>\n        </div>\n      </main>\n    );\n  }\n\n  // Loading screen for tasks\n  if (tasksLoading) {\n    return (\n      <main className=\"min-h-dvh flex items-center justify-center bg-white text-slate-900\">\n        <div className=\"text-center space-y-2\">\n          <p className=\"text-sm text-slate-600\">Loading writing tasks‚Ä¶</p>\n        </div>\n      </main>\n    );\n  }\n\n  if (tasksError) {\n    return (\n      <main className=\"min-h-dvh flex items-center justify-center bg-white text-slate-900\">\n        <div className=\"text-center space-y-2\">\n          <p className=\"text-sm text-red-600\">\n            Failed to load writing tasks: {tasksError}\n          </p>\n        </div>\n      </main>\n    );\n  }\n\n    return (\n      <main className=\"min-h-dvh bg-white text-slate-900 p-6\">\n        {/* Welcome-back progress popup (Step 12C) */}\n        {showWelcomeModal && progressSummary && (\n          <div className=\"fixed inset-0 z-40 flex items-center justify-center bg-black/40\">\n            <Card className=\"w-full max-w-md mx-4 p-6 space-y-4 bg-white shadow-xl rounded-2xl\">\n              <div className=\"flex items-start justify-between gap-3\">\n                <div>\n                  <h2 className=\"text-lg font-semibold\">Welcome back üëã</h2>\n                  <p className=\"text-xs text-slate-500 mt-1\">\n                    Here&apos;s a quick snapshot of your IELTS writing progress.\n                  </p>\n                </div>\n                <button\n                  aria-label=\"Close\"\n                  className=\"text-slate-400 hover:text-slate-600 text-sm\"\n                  onClick={() => setShowWelcomeModal(false)}\n                >\n                  ‚úï\n                </button>\n              </div>\n\n              <div className=\"grid grid-cols-2 gap-3 text-xs\">\n                <div className=\"rounded-md bg-slate-50 p-3\">\n                  <p className=\"text-[10px] uppercase text-slate-500\">\n                    Total attempts\n                  </p>\n                  <p className=\"mt-1 text-lg font-semibold\">\n                    {progressSummary.totalAttempts}\n                  </p>\n                </div>\n\n                <div className=\"rounded-md bg-slate-50 p-3\">\n                  <p className=\"text-[10px] uppercase text-slate-500\">\n                    Scored attempts\n                  </p>\n                  <p className=\"mt-1 text-lg font-semibold\">\n                    {progressSummary.scoredAttempts}\n                  </p>\n                </div>\n\n                <div className=\"rounded-md bg-slate-50 p-3\">\n                  <p className=\"text-[10px] uppercase text-slate-500\">\n                    Best overall band\n                  </p>\n                  <p className=\"mt-1 text-lg font-semibold\">\n                    {progressSummary.bestOverall !== null\n                      ? progressSummary.bestOverall.toFixed(1)\n                      : \"‚Äî\"}\n                  </p>\n                </div>\n\n                <div className=\"rounded-md bg-slate-50 p-3\">\n                  <p className=\"text-[10px] uppercase text-slate-500\">\n                    Last attempt (overall)\n                  </p>\n                  <p className=\"mt-1 text-lg font-semibold\">\n                    {progressSummary.lastOverall !== null\n                      ? progressSummary.lastOverall.toFixed(1)\n                      : \"‚Äî\"}\n                  </p>\n                </div>\n              </div>\n\n              <div className=\"flex justify-between gap-2 pt-1\">\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => setShowWelcomeModal(false)}\n                >\n                  Close\n                </Button>\n                <Button size=\"sm\" asChild>\n                  <Link href=\"/progress\">\n                    Open full dashboard ‚Üí\n                  </Link>\n                </Button>\n              </div>\n            </Card>\n          </div>\n        )}\n\n        <div className=\"mx-auto max-w-3xl space-y-6 p-6\">\n          <header className=\"flex items-center justify-between\">\n            <div>\n              <h1 className=\"text-2xl font-semibold\">IELTS Writing Practice</h1>\n              <p className=\"text-xs text-slate-500 mt-1\">\n                Choose a task, start the timer, and get instant AI band scores.\n              </p>\n            </div>\n          </header>\n\n        {userId && (\n          <div className=\"flex justify-end\">\n            <Link\n              href=\"/progress\"\n              className=\"text-xs text-slate-500 underline-offset-2 hover:underline\"\n            >\n              View your progress ‚Üí\n            </Link>\n          </div>\n        )}\n\n        {/* CONFIG PANEL */}\n        <Card className=\"p-4 space-y-4\">\n          <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4\">\n\n            {/* MODULE */}\n            <div className=\"space-y-2\">\n              <Label>Module</Label>\n              <Select\n                value={mode}\n                onValueChange={(v) => {\n                  setMode(v as any);\n                  setSelectedTaskId(null);\n                  setIsRunning(false);\n                  setResetToken(t => t + 1);\n                  resetFeedback();\n                  setEssay('');\n                }}\n              >\n                <SelectTrigger><SelectValue /></SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"academic\">Academic</SelectItem>\n                  <SelectItem value=\"general\">General</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* TASK */}\n            <div className=\"space-y-2\">\n              <Label>Task</Label>\n              <Select\n                value={task}\n                onValueChange={(v) => {\n                  const t = v as 'task1' | 'task2';\n                  setTask(t);\n                  setSelectedTaskId(null);\n                  setIsRunning(false);\n                  setDuration(defaultDurationForTask(t));\n                  setResetToken(k => k + 1);\n                  resetFeedback();\n                  setEssay('');\n                }}\n              >\n                <SelectTrigger><SelectValue /></SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"task1\">Task 1 (20 min / 150 words)</SelectItem>\n                  <SelectItem value=\"task2\">Task 2 (40 min / 250 words)</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n\n            {/* DURATION */}\n            <div className=\"space-y-2\">\n              <Label>Duration</Label>\n              <Select\n                value={String(duration)}\n                onValueChange={(v) => {\n                  setDuration(Number(v));\n                  setIsRunning(false);\n                  setResetToken(t => t + 1);\n                }}\n              >\n                <SelectTrigger><SelectValue /></SelectTrigger>\n                <SelectContent>\n                  <SelectItem value={(20 * 60).toString()}>20 min (Task 1)</SelectItem>\n                  <SelectItem value={(40 * 60).toString()}>40 min (Task 2)</SelectItem>\n                  <SelectItem value={(60 * 60).toString()}>60 min (Full test)</SelectItem>\n                </SelectContent>\n              </Select>\n            </div>\n          </div>\n\n          {/* TIMER + CONTROLS */}\n          <div className=\"flex flex-col gap-3 md:flex-row md:items-center md:justify-between\">\n            <div className=\"flex flex-col items-start gap-1\">\n              <Timer\n                key={`${mode}-${task}-${duration}-${selectedTaskId}-${resetToken}`}\n                initialSeconds={duration}\n                isRunning={isRunning}\n                onComplete={() => setIsRunning(false)}\n              />\n              <p className=\"text-[11px] text-slate-500\">\n                Minimum words for this task: <span className=\"font-medium\">{minWords}</span>\n              </p>\n            </div>\n\n            <div className=\"flex flex-wrap items-center gap-3\">\n              {/* Pro toggle */}\n              <label className=\"flex items-center gap-2 text-xs text-slate-600\">\n                <input\n                  type=\"checkbox\"\n                  checked={isPro}\n                  onChange={(e) => setIsPro(e.target.checked)}\n                  className=\"h-4 w-4\"\n                />\n                <span>\n                  Use <span className=\"font-semibold\">Pro scoring</span> (gpt-4o)\n                </span>\n              </label>\n\n              <Button\n                variant=\"outline\"\n                onClick={() => setIsRunning(!isRunning)}\n              >\n                {isRunning ? \"Pause exam\" : \"Start exam\"}\n              </Button>\n              <Button\n                variant=\"outline\"\n                onClick={() => { setIsRunning(false); setResetToken(t => t + 1); }}\n              >\n                Reset timer\n              </Button>\n              <Button\n                variant=\"secondary\"\n                onClick={() => {\n                  setEssay('');\n                  resetFeedback();\n                }}\n              >\n                Clear essay\n              </Button>\n              <Button\n                variant=\"default\"\n                onClick={handleSubmit}\n              >\n                Submit (AI scoring)\n              </Button>\n            </div>\n          </div>\n\n          <p className=\"text-xs text-slate-500\">\n            Scoring model: {isPro ? \"Pro (gpt-4o)\" : \"Free (gpt-4o-mini, suitable for practice)\"}.\n          </p>\n        </Card>\n\n        {/* QUESTION + ESSAY */}\n        <Card className=\"p-4 space-y-4\">\n          {/* QUESTION SELECTOR */}\n          <div className=\"space-y-2\">\n            <Label>Question</Label>\n            <Select\n              value={selectedTask?.id ?? \"\"}\n              onValueChange={(id) => {\n                setSelectedTaskId(id);\n                setIsRunning(false);\n                setResetToken(t => t + 1);\n                resetFeedback();\n                setEssay('');\n              }}\n            >\n              <SelectTrigger>\n                <SelectValue placeholder=\"Choose a question\" />\n              </SelectTrigger>\n              <SelectContent>\n                {tasks.map((t: any) => (\n                  <SelectItem key={t.id} value={t.id}>\n                    {t.title ??\n                      t.prompt.slice(0, 60) +\n                      (t.prompt.length > 60 ? \"‚Ä¶\" : \"\")}\n                  </SelectItem>\n                ))}\n              </SelectContent>\n            </Select>\n          </div>\n\n          {/* QUESTION PANEL */}\n          {selectedTask && (\n            <div className=\"rounded-md bg-slate-50 p-3 text-sm text-slate-700 space-y-3\">\n              {/* Diagram / Chart description for Task 1 */}\n              {selectedTask.task_type.startsWith(\"task1_\") &&\n                (selectedTask as any).diagram_alt && (\n                  <div className=\"rounded-md border border-dashed border-slate-300 bg-white p-3 text-xs text-slate-600\">\n                    <strong>Diagram description:</strong>{\" \"}\n                    {(selectedTask as any).diagram_alt}\n                  </div>\n                )}\n\n              {/* Meta row: module, task, min words, kind */}\n              <div className=\"flex flex-wrap items-center gap-2 text-[11px] uppercase tracking-wide text-slate-500\">\n                <span className=\"rounded-full bg-slate-200 px-2 py-0.5 font-semibold text-slate-700\">\n                  {mode === \"academic\" ? \"Academic\" : \"General Training\"}\n                </span>\n                <span className=\"rounded-full bg-slate-200 px-2 py-0.5 font-semibold text-slate-700\">\n                  {task === \"task1\"\n                    ? `Task 1 ‚Ä¢ ${minWords} words`\n                    : `Task 2 ‚Ä¢ ${minWords} words`}\n                </span>\n                <span className=\"rounded-full bg-slate-200 px-2 py-0.5 text-slate-700\">\n                  {selectedTask.task_type.startsWith(\"task2_\")\n                    ? \"Essay\"\n                    : selectedTask.task_type === \"task1_general\"\n                      ? \"Letter\"\n                      : \"Chart / Diagram\"}\n                </span>\n              </div>\n\n              <div>\n                <strong>Question:</strong> {selectedTask.prompt}\n              </div>\n            </div>\n          )}\n\n          <EssayBox\n            value={essay}\n            onChange={(text) => {\n              if (!isRunning && essay.trim().length === 0 && text.trim().length > 0) {\n                setIsRunning(true);\n              }\n              setEssay(text);\n            }}\n          />\n\n          <p className=\"text-xs text-slate-500\" suppressHydrationWarning>\n            Current words: {currentWordCount} / minimum {minWords}\n          </p>\n\n          {/* AUTOSAVE STATUS LINE */}\n          <p className=\"text-xs text-slate-500\" suppressHydrationWarning>\n            {!userId && (\n              <>Cloud autosave is off (not logged in). Local backup is still active in this browser.</>\n            )}\n\n            {userId && !selectedTaskId && (\n              <>Select a task to enable cloud autosave.</>\n            )}\n\n            {userId && selectedTaskId && autosaveStatus === \"saving\" && (\n              <>Saving draft‚Ä¶</>\n            )}\n\n            {userId && selectedTaskId && autosaveStatus === \"saved\" && lastSavedAt && (\n              <>\n                Saved at{\" \"}\n                {new Date(lastSavedAt).toLocaleTimeString([], {\n                  hour: \"2-digit\",\n                  minute: \"2-digit\",\n                })}\n              </>\n            )}\n\n            {userId && selectedTaskId && autosaveStatus === \"error\" && (\n              <>Autosave failed ‚Äî changes are not yet saved in the cloud.</>\n            )}\n          </p>\n        </Card>\n\n        {/* SELF-ASSESSMENT CARD */}\n        <Card className=\"p-4 space-y-4\">\n          <div className=\"flex items-center justify-between\">\n            <div>\n              <h2 className=\"text-lg font-semibold\">Self-assessment (optional)</h2>\n              <p className=\"text-xs text-slate-500\">\n                Use the sliders to predict your band before submitting. Your prediction will lock for this attempt once you click &quot;Submit&quot;.\n              </p>\n            </div>\n            {predictionLocked && (\n              <span className=\"rounded-full bg-slate-100 px-3 py-1 text-xs text-slate-600\">\n                Prediction locked\n              </span>\n            )}\n          </div>\n\n          <div className=\"rounded-md bg-slate-50 p-3 text-sm\">\n            <p className=\"text-xs uppercase text-slate-500\">Your predicted overall band</p>\n            <div className=\"mt-1 flex items-baseline gap-2\">\n              <span className=\"text-3xl font-semibold\">\n                {hasPrediction ? livePredictedOverall.toFixed(1) : '‚Äî'}\n              </span>\n              <span className=\"text-xs text-slate-500\">\n                Move the sliders below to set your guess.\n              </span>\n            </div>\n          </div>\n\n          <div className=\"space-y-4 text-sm\">\n            {/* Task Response */}\n            <div>\n              <div className=\"flex items-center justify-between\">\n                <Label>Task Response</Label>\n                <span className=\"text-xs text-slate-500\">\n                  Band {selfScores.taskResponse.toFixed(1)}\n                </span>\n              </div>\n              <input\n                type=\"range\"\n                min={0}\n                max={9}\n                step={0.5}\n                disabled={predictionLocked}\n                value={selfScores.taskResponse}\n                onChange={(e) => {\n                  setHasPrediction(true);\n                  const val = parseFloat(e.target.value);\n                  setSelfScores(prev => ({ ...prev, taskResponse: val }));\n                }}\n                className=\"mt-2 w-full\"\n              />\n            </div>\n\n            {/* Coherence */}\n            <div>\n              <div className=\"flex items-center justify-between\">\n                <Label>Coherence & Cohesion</Label>\n                <span className=\"text-xs text-slate-500\">\n                  Band {selfScores.coherence.toFixed(1)}\n                </span>\n              </div>\n              <input\n                type=\"range\"\n                min={0}\n                max={9}\n                step={0.5}\n                disabled={predictionLocked}\n                value={selfScores.coherence}\n                onChange={(e) => {\n                  setHasPrediction(true);\n                  const val = parseFloat(e.target.value);\n                  setSelfScores(prev => ({ ...prev, coherence: val }));\n                }}\n                className=\"mt-2 w-full\"\n              />\n            </div>\n\n            {/* Lexical Resource */}\n            <div>\n              <div className=\"flex items-center justify-between\">\n                <Label>Lexical Resource</Label>\n                <span className=\"text-xs text-slate-500\">\n                  Band {selfScores.lexical.toFixed(1)}\n                </span>\n              </div>\n              <input\n                type=\"range\"\n                min={0}\n                max={9}\n                step={0.5}\n                disabled={predictionLocked}\n                value={selfScores.lexical}\n                onChange={(e) => {\n                  setHasPrediction(true);\n                  const val = parseFloat(e.target.value);\n                  setSelfScores(prev => ({ ...prev, lexical: val }));\n                }}\n                className=\"mt-2 w-full\"\n              />\n            </div>\n\n            {/* Grammar */}\n            <div>\n              <div className=\"flex items-center justify-between\">\n                <Label>Grammatical Range & Accuracy</Label>\n                <span className=\"text-xs text-slate-500\">\n                  Band {selfScores.grammar.toFixed(1)}\n                </span>\n              </div>\n              <input\n                type=\"range\"\n                min={0}\n                max={9}\n                step={0.5}\n                disabled={predictionLocked}\n                value={selfScores.grammar}\n                onChange={(e) => {\n                  setHasPrediction(true);\n                  const val = parseFloat(e.target.value);\n                  setSelfScores(prev => ({ ...prev, grammar: val }));\n                }}\n                className=\"mt-2 w-full\"\n              />\n            </div>\n          </div>\n        </Card>\n\n        {/* RESULTS PANEL */}\n        {showResults && aiResult && (\n          <BandScoreModal\n            task={task}\n            wordCount={currentWordCount}\n            minWords={minWords}\n            aiData={aiResult}\n            prediction={prediction}\n            isPro={isPro}\n            onClose={() => {\n              setShowResults(false);\n            }}\n          />\n        )}\n      </div>\n    </main>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}